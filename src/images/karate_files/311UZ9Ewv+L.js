(function(n){var e=window.AmazonUIPageJS||window.P,q=e._namespace||e.attributeErrors,d=q?q("PageRefreshAsset",""):e;d.guardFatal?d.guardFatal(n)(d,window):d.execute(function(){n(d,window)})})(function(n,e,q){n.when("A","page-refresh-state","web-ajax-utility","alt-page-refresh-measurement","state-aware-feature-consolidator","page-refresh-utils","dp-interactive-page-refresh-handler","dp-click-to-ci-utils").register("page-refresh-handler",function(d,h,m,c,f,b,g,a){var k={},l=d.$,r={},t="",n,u="",v=function(k,
h,e,v,w){var p=this;p.clientId=k;p.clientName=h.toLowerCase();p.doPageRefresh=function(b,c,l){var d={},d=x(b);if(d!==q&&""!==d&&" "!==d){d=f.getStateAwareParameters();b=y(b,d);g.createInteractivityObjectForTwisterUpdate();var h=this,e;e=m.getInstance(k,b,{success:function(){var b=arguments[arguments.length-1];b&&!b.isResponseFromCache?h.pageRefreshMeasurement&&u&&(b=e.xhr.http.getResponseHeader("x-amz-rid"),h.pageRefreshMeasurement.setRequestId(u,b),u=""):a.logCounter("CachedTwisterMetric-Desktop");
c.success.apply(null,arguments)},chunk:c.chunk,failure:c.failure},l,w);e.getContent()}else throw"triggerEvent parameter missing or invalid";};p.addParams=function(a){r=l.extend(!0,r,a);return!0};p.removeParams=function(a){d.each(a,function(a,b){delete r[a];delete t[a]});return!0};p.createCustomParamsMap=function(a,b){var c={Persistent:{},"Non-Persistent":{}};l.each(a,function(a,b){c.Persistent[a]=b});l.each(b,function(a,b){c["Non-Persistent"][a]=b});return c};p.startMeasurement=function(a,b,c,l,g,
k){u=a;this.pageRefreshMeasurement&&this.pageRefreshMeasurement.start(a,b,c,l,g,k)};p.stampImageLoad=function(a){this.pageRefreshMeasurement&&this.pageRefreshMeasurement.stampImageLoad(a)};p.stampFeature=function(a,b){this.pageRefreshMeasurement&&this.pageRefreshMeasurement.stampFeature(a,b)};p.fadeInFeatures=function(a){"undefined"!==typeof a&&a.length||(a=n[p.clientName]);b.fadeInFeatures(a)};var x=function(a){var b="";a=a["Non-Persistent"];a.hasOwnProperty("triggerEvent")&&(b=a.triggerEvent);return b},
z=function(){l.each(t,function(a,b){r.hasOwnProperty(a)&&(t[a]=r[a])})},A=function(a){var b={},c=Object.keys(a);c.sort();l.each(c,function(c,l){b[l]=a[l]});return b},y=function(a,b){r=l.extend(!0,r,a.Persistent);z();var c=d.copy(t);l.extend(!0,c,r,a["Non-Persistent"],b);a=e;b=d.contains(a,"?");a+=b?"\x26":"?";var c=A(c),g;for(g in c)if(null!=c[g]){b=c[g];var k=a.slice(-1);a+="?"===k||"\x26"===k?"":"\x26";a+=g+"\x3d"+b}return a};(function(){if(v){var a=v.config;p.pageRefreshMeasurement=new c(l,a.atf.marker,
a.cf.marker)}})()};(function(){var a=h.fetchPageRefreshData();t=a.pageRefreshUrlParams;n=a.divToUpdateData})();return{getHandlerInstance:function(a,b,c,l){(null==a||""===a)&&e.ueLogError&&e.ueLogError({message:"Invalid ClientId"},{logLevel:"FATAL",attribution:"PageRefreshAPI",message:"Invalid ClientId passed to getHandlerInstance of dpRefreshHandler"});k[a]||(k[a]=new v(a,b,c,l));return k[a]},getPersistentParams:function(){return r}}});"use strict";n.when("A","page-refresh-handler").register("dp-refresh-handler",
function(d,h){function m(c,f,b,g){this.featureTriggeringRefresh=c.featureName;this.deviceTypeStateData=d.state("detail-page-device-type");"undefined"===typeof this.deviceTypeStateData&&(this.deviceTypeStateData=d.state("page-refresh-device-type"));this.deviceType=this.deviceTypeStateData&&this.deviceTypeStateData.deviceType?this.deviceTypeStateData.deviceType:"web";this.pageRefreshUrl=b&&b.pageRefreshUrl?b.pageRefreshUrl:"/gp/page/refresh";this.clientId="PageRefresh_"+this.deviceType+"_"+this.featureTriggeringRefresh+
"_Client";this.DPRefreshHandler=h.getHandlerInstance(this.clientId,this.featureTriggeringRefresh,this.pageRefreshUrl,f,g)}m.prototype={doPageRefresh:function(c,f,b){try{this.DPRefreshHandler.doPageRefresh(c,f,b)}catch(g){e.ueLogError&&e.ueLogError(g,{logLevel:"ERROR",attribution:this.featureTriggeringRefresh,message:"This error is caused by the doPageRefresh method triggered by - "+this.featureTriggeringRefresh+": "+g})}},createCustomParamsMap:function(c,f){var b={};try{b=this.DPRefreshHandler.createCustomParamsMap(c,
f)}catch(g){e.ueLogError&&e.ueLogError(g,{logLevel:"ERROR",attribution:this.featureTriggeringRefresh,message:"This error is caused by the createCustomParamsMap method triggered by - "+this.featureTriggeringRefresh+": "+g})}return b},addParams:function(c){return c&&"object"==typeof c?this.DPRefreshHandler.addParams(c):!1},removeParams:function(c){return c&&"object"==typeof c?this.DPRefreshHandler.removeParams(c):!1},startMeasurement:function(c,f,b,g,a,k){try{this.DPRefreshHandler.startMeasurement(c,
f,b,g,a,k)}catch(l){e.ueLogError&&e.ueLogError(l,{logLevel:"ERROR",attribution:this.featureTriggeringRefresh,message:"This error is caused by the startMeasurement method triggered by - "+this.featureTriggeringRefresh+": "+l})}},stampImageLoad:function(c){try{this.DPRefreshHandler.stampImageLoad(c)}catch(f){e.ueLogError&&e.ueLogError(f,{logLevel:"ERROR",attribution:this.featureTriggeringRefresh,message:"This error is caused by the startMeasurement method triggered by - "+this.featureTriggeringRefresh+
": "+f})}},stampFeature:function(c,f){try{this.DPRefreshHandler.stampFeature(c,f)}catch(b){e.ueLogError&&e.ueLogError(b,{logLevel:"ERROR",attribution:this.featureTriggeringRefresh,message:"This error is caused by the startMeasurement method triggered by - "+this.featureTriggeringRefresh+": "+b})}},fadeInFeatures:function(c){try{this.DPRefreshHandler.fadeInFeatures(c)}catch(f){e.ueLogError&&e.ueLogError(f,{logLevel:"ERROR",attribution:this.featureTriggeringRefresh,message:"This error is caused by the fadeInFeatures method triggered by - "+
this.featureTriggeringRefresh+": "+f})}}};return m});n.when("A","jQuery","dp-interactive-page-refresh-handler","dp-click-to-ci-utils").register("alt-page-refresh-ajax-scope",function(d,h,m,c){return function(f,b,g,a){this.scopeName=b;this.customPageTypeId=g;this.customTags=a;this.requestIdAvailable=!1;ues("t0",b,e.newTwisterInteractionStartTime);ues("ctb",b,"1");this.signalMarker=function(a){!this.markers[a]||0>=this.markers[a].conditions||0===--this.markers[a].conditions&&"function"==typeof this.markers[a].handler&&
this.markers[a].handler()};this.addlongPoleTag=function(a,b){a=a.toLowerCase();this.markers[a]&&0==this.markers[a].conditions&&0==this.markers[a].conditions&&e.ue&&"function"===typeof ue.tag&&ue.tag(b)};this.setRequestId=function(a){a&&(this.requestIdAvailable=!0,this.postData(a))};this.markClickToCI=function(){var a=this,b=m.getClickToCIMetric();b&&b.then(function(b){uet("fn",a.scopeName,q,b.interactiveTime);a.requestIdAvailable&&uex("ld",lScopeName);c.logCounter("TTISuccessCountForTwisterUpdate")}).catch(function(a){c.logCounter("TTIFailureCountForTwisterUpdate")})};
this.postData=function(a){var b=this.scopeName,c=this.customPageTypeId,g=this.customTags;ues("id",b,a);var k;c!==q&&(k=e.ue_pti,e.ue_pti=c);if(g!==q)for(a=0;a<g.length;a++)ue.tag(g[a]);uex("ld",b);c!==q&&(e.ue_pti=k)};var k=this;this.markers={image:{conditions:1,handler:function(){uet("ne",b);k.signalMarker("af")}},af:{conditions:Twister.atfMarkerCount?Twister.atfMarkerCount:2,handler:function(){d.trigger("PageRefresh:ATF");uet("af",b);uet("cf",b);k.signalMarker("cf");m.updateCriticalFeatures();k.markClickToCI()}},
cf:{conditions:Twister.cfMarkerCount?Twister.cfMarkerCount:2,handler:function(){d.trigger("PageRefresh:CF");uet("cf",b)}}}}});n.when("A","jQuery","alt-page-refresh-ajax-scope").register("alt-page-refresh-measurement",function(d,h,m){return function(c,f,b){this.atfMarker=f;this.cfMarker=b;this.scopeCount={};this.ajaxScopes={};this.start=function(b,a,k,f,d,h){e.ue&&(this.scopeCount[b]||(this.scopeCount[b]=0),a=b+(this.scopeCount[b]+1),this.scopeCount[b]++,this.ajaxScopes[b]=new m(c,a,d,h))};this.setRequestId=
function(b,a){this.ajaxScopes[b]&&this.ajaxScopes[b].setRequestId(a)};this.stampImageLoad=function(b){this.ajaxScopes[b]&&(this.ajaxScopes[b].signalMarker("image"),Twister.cfImageLongPollTag&&this.ajaxScopes[b].addlongPoleTag("cf",Twister.cfImageLongPollTag))};this.stampFeature=function(b,a){this.ajaxScopes[a]&&(b===this.atfMarker&&this.ajaxScopes[a].signalMarker("af"),b===this.cfMarker&&(this.ajaxScopes[a].signalMarker("cf"),Twister.cfHtmlLongPollTag&&this.ajaxScopes[a].addlongPoleTag("cf",Twister.cfHtmlLongPollTag)))};
this.stampCustomMetrics=function(b,a){this.ajaxScopes[a]&&uet(b,this.ajaxScopes[a].scopeName)}}});n.when("A","ready","page-refresh-js-init-dpx-data","page-refresh-js-init-mason-data").register("page-refresh-state",function(d,h,e,c){function f(){var a=b.extend(!0,{},e.divToUpdateData,c.divToUpdateData),k={};d.each(a,function(a,b){k[b]=[];d.each(a,function(a){(a=a.divToUpdate)&&k[b].push(a)})});return k}var b=d.$,g=d.state("page-refresh-data-mason"),a=d.state("page-refresh-data-dpx"),k=d.state("detail-page-device-type"),
l={};"undefined"===typeof k&&(k=d.state("page-refresh-device-type"));return{fetchPageRefreshData:function(){var c=g&&g.pageRefreshUrlParams?g.pageRefreshUrlParams:{},d=a&&a.pageRefreshUrlParams?a.pageRefreshUrlParams:{};l.pageRefreshUrlParams={};b.extend(!0,l.pageRefreshUrlParams,c,d);"undefined"!==typeof k&&(l.deviceType=k.deviceType);l.divToUpdateData=f();return l}}});n.when("A","jQuery","page-refresh-utils","cache","dp-click-to-ci-utils").register("web-ajax-utility",function(d,h,m,c,f){function b(a,
b,c,d,f){this.scope=a;this.url=b;this.options=c;this.useCustomRefreshBehavior=f;this.status=0;this.selected=!1;this.error=this.successData=this.xhr=this._status=q;this.chunks=[];this.doNotAbort=d||!1}var g=new c;b._objects={};b.prototype._initializeChunks=function(){var a=!1;g.exists(this.url)&&(a=!0,this.chunks=g.get(this.url));return a};b.prototype._callback=function(){var a=arguments[0],b=Array.prototype.slice.call(arguments,1);"function"===typeof a&&a.apply(self,b)};b.prototype._canAbort=function(){return!this.doNotAbort&&
1===this.status};b.prototype._isAborted=function(){return 3===this.status};b.prototype._getUrl=function(){return this.url};b.prototype._abort=function(){if(1===this.status)try{this.ajaxRequestRefence.abort(),this.status=3}catch(b){var a={message:"Could not abort ajax request. "};"string"===typeof b&&(a.message+=b,b=q);a.logLevel="FATAL";e.ueLogError&&e.ueLogError(b,a)}};b.prototype._flushChunkData=function(){var a=this;a.chunks.length&&h.map(a.chunks,function(b){a.useCustomRefreshBehavior||m.refreshFeature(b);
a._callback(a.options.chunk,b)})};b.prototype._request=function(){var a=this;a.ajaxRequestRefence=d.get(a.url,{params:a.options.params,success:function(b,c,f){a.status=4;a.successData=b;a._status=c;a.xhr=f;g.put(a.url,a.chunks);a.chunks=[];a.selected&&(a.useCustomRefreshBehavior||m.removeOverlayForAllFeatures(),a._callback(a.options.success,b,c,f,{isResponseFromCache:!1}));d.trigger("PageRefresh:Success")},error:function(b,c,f){a.status=2;a.xhr=b;a._status=c;a.error=f;a.selected&&(a.useCustomRefreshBehavior||
m.removeOverlayForAllFeatures(),a._callback(a.options.error,b,c,f))},abort:function(b){a.status=3;a.xhr=b;a.selected&&a._callback(a.options.abort,b)},chunk:function(b){b&&(a.chunks.push(b),a.selected&&(a.useCustomRefreshBehavior||m.refreshFeature(b),a._callback(a.options.chunk,b)))},timeout:a.options.timeout||4E4})};b.prototype.getContent=function(){b._abortRequestsExcept(this);this.selected=!0;var a=this._initializeChunks();a&&(this.status=4,f.logCounter("CachedTwisterUpdate"));0===this.status?(this.status=
1,this._request()):1===this.status?this._flushChunkData():4===this.status&&(a?(this._flushChunkData(),this.useCustomRefreshBehavior||m.removeOverlayForAllFeatures(),this._callback(this.options.success,this.successData,this._status,this.xhr,{isResponseFromCache:!0}),d.trigger("a:pageUpdate"),d.trigger("PageRefresh:Success")):(this.status=1,this._request()))};b._abortRequestsExcept=function(a){h.each(b._objects[a.scope],function(b,c){c._canAbort()&&b!==a._getUrl()&&c._abort()})};b.getInstance=function(a,
c,f,d,g){if(!a||!c||"object"!==typeof f)throw"Incorrect parameter passed.";g=g||!1;b._objects[a]=b._objects[a]||{};var h=b._objects[a][c];h&&h._isAborted()&&(delete b._objects[a][c],h=q);h||(b._objects[a][c]=new b(a,c,f,d,g,this));return b._objects[a][c]};return b});n.when("A").register("state-aware-critical-features",function(d){return function(){var d=[];this.add=function(e,c){for(var f=e.featureName,b=!1,g=0;g<d.length;g++)if(d[g].featureName===f){b=!0;break}if(b)throw"Critical Feature "+e.featureName+
" already registered for State Aware Messaging!";e={};e.featureName=f;e.callback=c;d.push(e)};this.getAllCriticalFeatures=function(){return d}}});n.when("A","state-aware-parameter-handler").register("state-aware-feature-consolidator",function(d,e){return{getStateAwareParameters:function(){return e.getStateAwareParameters()}}});n.when("A","state-aware-critical-features","state-aware-parameters").register("state-aware-parameter-handler",function(d,h,m){return new function(){var c=new h,d=new m;this.registerCriticalFeature=
function(b,d){try{if("function"===typeof d)c.add(b,d);else throw"callback needs to be a function!";}catch(a){e.ueLogError&&e.ueLogError(a,{logLevel:"ERROR",attribution:b.featureName,message:"StateAwareExceptionMessaging:- This error is caused by the feature "+b.featureName+" while registering itself as a critical feature for State Aware Messaging. "+a})}};this.getStateAwareParameters=function(){for(var b=c.getAllCriticalFeatures(),g=0;g<b.length;g++){var a=b[g],h=a.featureName,a=a.callback.apply();
try{d.putParameters(h,a)}catch(l){e.ueLogError&&e.ueLogError(l,{logLevel:"ERROR",attribution:h,message:"StateAwareMessaging:- This error is caused by the feature "+h+" while injecting state aware parameters. "+l})}}return d.getAllStateAwareParameters()}}});n.when("A").register("state-aware-parameters",function(){return function(){var d={};this.putParameters=function(e,m){var c=!0;for(feature in d)if(d.hasOwnProperty(feature)&&e!==feature){var f=this.getParameters(feature);if(c){var c=m,b=!1;for(paramKey in c)if(c.hasOwnProperty(paramKey)&&
f.hasOwnProperty(paramKey)){b=!0;break}c=!b}}if(c)for(paramKey in m)m.hasOwnProperty(paramKey)&&(f=m[paramKey],d[e]||(d[e]={}),d[e][paramKey]=f);else throw"Duplicate Parameters found for other Critical Feature!";};this.getParameters=function(e){return d[e]};this.getAllStateAwareParameters=function(){var e={},m;for(m in d)if(d.hasOwnProperty(m)){var c=this.getParameters(m),f;for(f in c)c.hasOwnProperty(f)&&(e[f]=c[f])}return e}}});n.when("A").register("page-refresh-utils",function(d){var h=d.$,m={intermediateEOS:1,
EOS:1};return{fadeInFeatures:function(c){h.each(c,function(b,d){"#"!==d[0]&&(c[b]="#"+d)});var d=c.join(",");h(d).addClass("js-feature-refresh-overlay");h(d).css("opacity",.5)},refreshFeature:function(c){var d=c.Value;c=c.FeatureName;if(!m[c]){var b,g;try{c&&d&&d.content&&(g=d.content[c],"undefined"!==typeof g&&(b=h("#"+c),b.html(g),b.removeClass("js-feature-refresh-overlay"),b.css("opacity","")))}catch(a){d={message:"Error in feature"+(c||"NoFeatureName"),logLevel:"FATAL"},e.ueLogError&&e.ueLogError(a,
d)}}},removeOverlayForAllFeatures:function(c){c=h("body").find(".js-feature-refresh-overlay");for(var d=0;d<c.length;d++){var b=c[d];h(b).removeClass("js-feature-refresh-overlay");h(b).css("opacity","")}}}})});